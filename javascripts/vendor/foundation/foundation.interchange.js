!function(t,e){"use strict";Foundation.libs.interchange={name:"interchange",version:"5.5.0",cache:{},images_loaded:!1,nodes_loaded:!1,settings:{load_attr:"interchange",named_queries:{"default":"only screen",small:Foundation.media_queries.small,"small-only":Foundation.media_queries["small-only"],medium:Foundation.media_queries.medium,"medium-only":Foundation.media_queries["medium-only"],large:Foundation.media_queries.large,"large-only":Foundation.media_queries["large-only"],xlarge:Foundation.media_queries.xlarge,"xlarge-only":Foundation.media_queries["xlarge-only"],xxlarge:Foundation.media_queries.xxlarge,landscape:"only screen and (orientation: landscape)",portrait:"only screen and (orientation: portrait)",retina:"only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (min--moz-device-pixel-ratio: 2),only screen and (-o-min-device-pixel-ratio: 2/1),only screen and (min-device-pixel-ratio: 2),only screen and (min-resolution: 192dpi),only screen and (min-resolution: 2dppx)"},directives:{replace:function(e,n,r){if(/IMG/.test(e[0].nodeName)){var i=e[0].src;if(new RegExp(n,"i").test(i))return;return e[0].src=n,r(e[0].src)}var a=e.data(this.data_attr+"-last-path"),o=this;if(a!=n)return/\.(gif|jpg|jpeg|tiff|png)([?#].*)?/i.test(n)?(t(e).css("background-image","url("+n+")"),e.data("interchange-last-path",n),r(n)):t.get(n,function(t){e.html(t),e.data(o.data_attr+"-last-path",n),r()})}}},init:function(e,n,r){Foundation.inherit(this,"throttle random_str"),this.data_attr=this.set_data_attr(),t.extend(!0,this.settings,n,r),this.bindings(n,r),this.load("images"),this.load("nodes")},get_media_hash:function(){var t="";for(var e in this.settings.named_queries)t+=matchMedia(this.settings.named_queries[e]).matches.toString();return t},events:function(){var n,r=this;return t(e).off(".interchange").on("resize.fndtn.interchange",r.throttle(function(){var t=r.get_media_hash();t!==n&&r.resize(),n=t},50)),this},resize:function(){var e=this.cache;if(!this.images_loaded||!this.nodes_loaded)return void setTimeout(t.proxy(this.resize,this),50);for(var n in e)if(e.hasOwnProperty(n)){var r=this.results(n,e[n]);r&&this.settings.directives[r.scenario[1]].call(this,r.el,r.scenario[0],function(){if(arguments[0]instanceof Array)var t=arguments[0];else var t=Array.prototype.slice.call(arguments,0);r.el.trigger(r.scenario[1],t)})}},results:function(t,e){var n=e.length;if(n>0)for(var r=this.S("["+this.add_namespace("data-uuid")+'="'+t+'"]');n--;){var i,a=e[n][2];if(i=matchMedia(this.settings.named_queries.hasOwnProperty(a)?this.settings.named_queries[a]:a),i.matches)return{el:r,scenario:e[n]}}return!1},load:function(t,e){return("undefined"==typeof this["cached_"+t]||e)&&this["update_"+t](),this["cached_"+t]},update_images:function(){var t=this.S("img["+this.data_attr+"]"),e=t.length,n=e,r=0,i=this.data_attr;for(this.cache={},this.cached_images=[],this.images_loaded=0===e;n--;){if(r++,t[n]){var a=t[n].getAttribute(i)||"";a.length>0&&this.cached_images.push(t[n])}r===e&&(this.images_loaded=!0,this.enhance("images"))}return this},update_nodes:function(){var t=this.S("["+this.data_attr+"]").not("img"),e=t.length,n=e,r=0,i=this.data_attr;for(this.cached_nodes=[],this.nodes_loaded=0===e;n--;){r++;var a=t[n].getAttribute(i)||"";a.length>0&&this.cached_nodes.push(t[n]),r===e&&(this.nodes_loaded=!0,this.enhance("nodes"))}return this},enhance:function(n){for(var r=this["cached_"+n].length;r--;)this.object(t(this["cached_"+n][r]));return t(e).trigger("resize").trigger("resize.fndtn.interchange")},convert_directive:function(t){var e=this.trim(t);return e.length>0?e:"replace"},parse_scenario:function(t){var e=t[0].match(/(.+),\s*(\w+)\s*$/),n=t[1];if(e)var r=e[1],i=e[2];else var a=t[0].split(/,\s*$/),r=a[0],i="";return[this.trim(r),this.convert_directive(i),this.trim(n)]},object:function(t){var e=this.parse_data_attr(t),n=[],r=e.length;if(r>0)for(;r--;){var i=e[r].split(/\(([^\)]*?)(\))$/);if(i.length>1){var a=this.parse_scenario(i);n.push(a)}}return this.store(t,n)},store:function(t,e){var n=this.random_str(),r=t.data(this.add_namespace("uuid",!0));return this.cache[r]?this.cache[r]:(t.attr(this.add_namespace("data-uuid"),n),this.cache[n]=e)},trim:function(e){return"string"==typeof e?t.trim(e):e},set_data_attr:function(t){return t?this.namespace.length>0?this.namespace+"-"+this.settings.load_attr:this.settings.load_attr:this.namespace.length>0?"data-"+this.namespace+"-"+this.settings.load_attr:"data-"+this.settings.load_attr},parse_data_attr:function(t){for(var e=t.attr(this.attr_name()).split(/\[(.*?)\]/),n=e.length,r=[];n--;)e[n].replace(/[\W\d]+/,"").length>4&&r.push(e[n]);return r},reflow:function(){this.load("images",!0),this.load("nodes",!0)}}}(jQuery,window,window.document);